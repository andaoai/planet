<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¤©ä½“å›¾æ–‡ - ä¸­å›½å¤©æ–‡å¯è§†åŒ–åº”ç”¨</title>
  <script src="js/lib/lunar.js"></script>
  <script src="js/lib/vue3.js"></script>
  <script src="js/lib/astronomy.browser.js?ver=2.4"></script>
  <link rel="stylesheet" href="css/styles.css">
  <style>
    /* å“åº”å¼å¸ƒå±€æ ·å¼ */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Microsoft YaHei", "å¾®è½¯é›…é»‘", Arial, sans-serif;
      background-color: #f5f5f5;
      line-height: 1.6;
    }

    .app-container {
      display: flex;
      min-height: 100vh;
      background-color: #f5f5f5;
    }

    /* å·¦ä¾§æ§åˆ¶é¢æ¿ */
    .control-panel {
      width: 320px;
      background-color: white;
      border-right: 1px solid #ddd;
      overflow-y: auto;
      box-shadow: 2px 0 5px rgba(0,0,0,0.1);
    }

    .control-panel-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .control-panel-header h1 {
      font-size: 1.5rem;
      margin-bottom: 5px;
    }

    .control-panel-header p {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .control-section {
      padding: 20px;
      border-bottom: 1px solid #eee;
    }

    .control-section:last-child {
      border-bottom: none;
    }

    .control-section h3 {
      color: #333;
      margin-bottom: 15px;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
    }

    .control-section h3::before {
      content: "ğŸŒŸ";
      margin-right: 8px;
    }

    /* ä¸»è¦å†…å®¹åŒºåŸŸ */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .canvas-container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      background-color: #fafafa;
    }

    #my {
      border: 2px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      background-color: white;
      max-width: 100%;
      max-height: 100%;
    }

    /* è¡¨å•æ§ä»¶æ ·å¼ */
    .checkbox-group {
      display: grid;
      gap: 8px;
    }

    .checkbox-item {
      display: flex;
      align-items: center;
      padding: 6px 0;
      transition: background-color 0.2s;
      border-radius: 4px;
    }

    .checkbox-item:hover {
      background-color: #f8f9fa;
    }

    .checkbox-item input[type="checkbox"] {
      margin-right: 8px;
      transform: scale(1.1);
    }

    .checkbox-item label {
      cursor: pointer;
      font-size: 0.9rem;
      line-height: 1.4;
    }

    /* æŒ‰é’®æ ·å¼ */
    .button-group {
      display: flex;
      gap: 8px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.2s;
      flex: 1;
      min-width: 80px;
    }

    .btn-primary {
      background-color: #007bff;
      color: white;
    }

    .btn-primary:hover {
      background-color: #0056b3;
    }

    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background-color: #545b62;
    }

    /* è¾“å…¥æ¡†æ ·å¼ */
    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #555;
    }

    .form-group input, .form-group select {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    .form-group input:focus, .form-group select:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
    }

    /* ä½ç½®è¾“å…¥ç»„ */
    .location-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    /* æ—¶é—´è¾“å…¥ç»„ */
    .time-inputs {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .time-inputs input {
      width: 60px;
      padding: 6px 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      text-align: center;
    }

    .time-span-input {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* å¿«æ·é”®è¯´æ˜ */
    .keyboard-shortcuts {
      background-color: #f8f9fa;
      border-radius: 4px;
      padding: 15px;
    }

    .keyboard-shortcuts h4 {
      color: #dc3545;
      margin-bottom: 10px;
      font-size: 1rem;
    }

    .keyboard-shortcuts ol {
      padding-left: 20px;
    }

    .keyboard-shortcuts li {
      margin-bottom: 8px;
      font-size: 0.85rem;
      line-height: 1.4;
    }

    /* åº•éƒ¨å¯¼èˆªæ  */
    .bottom-nav {
      background-color: white;
      border-top: 1px solid #ddd;
      padding: 15px 20px;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
    }

    .nav-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .nav-btn {
      padding: 10px 16px;
      border: 1px solid #ddd;
      background-color: white;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: all 0.2s;
      min-width: 80px;
    }

    .nav-btn:hover {
      background-color: #007bff;
      color: white;
      border-color: #007bff;
    }

    /* æŠ˜å é¢æ¿ */
    .collapsible {
      cursor: pointer;
    }

    .collapsible-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
    }

    .collapsible.active .collapsible-content {
      max-height: 1000px;
    }

    .collapsible.active h3::before {
      content: "ğŸ“‚";
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .app-container {
        flex-direction: column;
      }

      .control-panel {
        width: 100%;
        order: 2;
        max-height: 40vh;
      }

      .main-content {
        order: 1;
      }

      .canvas-container {
        min-height: 50vh;
      }

      .button-group {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }

    /* æ»šåŠ¨æ¡æ ·å¼ */
    .control-panel::-webkit-scrollbar {
      width: 6px;
    }

    .control-panel::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    .control-panel::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 3px;
    }

    .control-panel::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
  </style>
</head>

<body>
  <div id="app" class="app-container">
    <!-- å·¦ä¾§æ§åˆ¶é¢æ¿ -->
    <aside class="control-panel">
      <div class="control-panel-header">
        <h1>å¤©ä½“å›¾æ–‡</h1>
        <p>ä¸­å›½å¤©æ–‡å¯è§†åŒ–åº”ç”¨</p>
      </div>

      <!-- åŸºç¡€æ˜¾ç¤ºè®¾ç½® -->
      <div class="control-section">
        <h3>åŸºç¡€æ˜¾ç¤º</h3>
        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="guijiMode" v-model="settings.s.guijiMode">
            <label for="guijiMode">è½¨è¿¹æ¨¡å¼ (O)</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="faceMode" v-model="settings.s.faceMode">
            <label for="faceMode">ä¿¯è§†å›¾/ä¾§è§†å›¾ (I)</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="showPlanetDistance" v-model="settings.s.showPlanetDistance">
            <label for="showPlanetDistance">å±•ç¤ºè¡Œæ˜Ÿè·ç¦» (T)</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="showPlanetData" v-model="settings.s.showPlanetData">
            <label for="showPlanetData">æ˜¾ç¤ºè¡Œæ˜Ÿæ•°æ® (P)</label>
          </div>
        </div>
      </div>

      <!-- å†æ³•æ˜¾ç¤º -->
      <div class="control-section collapsible" :class="{ active: showCalendarSection }" @click="showCalendarSection = !showCalendarSection">
        <h3>å†æ³•æ˜¾ç¤º</h3>
        <div class="collapsible-content">
          <div class="checkbox-group">
            <div class="checkbox-item">
              <input type="checkbox" id="show24Jieqi" v-model="settings.s.show24Jieqi">
              <label for="show24Jieqi">æ˜¾ç¤º24èŠ‚æ°”åœˆ</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="show24JieqiClockwise" v-model="settings.s.show24JieqiClockwise">
              <label for="show24JieqiClockwise">24èŠ‚æ°”é¡ºæ—¶é’ˆ (L)</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="show28Xiu" v-model="settings.s.show28Xiu">
              <label for="show28Xiu">æ˜¾ç¤º28å®¿</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="showDouJian" v-model="settings.s.showDouJian">
              <label for="showDouJian">æ˜¾ç¤º12æœˆå†å¹´å»º</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="showYueJian" v-model="settings.s.showYueJian">
              <label for="showYueJian">æ˜¾ç¤º12æœˆå†æœˆå»º</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="show10Yueli" v-model="settings.s.show10Yueli">
              <label for="show10Yueli">æ˜¾ç¤º10æœˆå†</label>
            </div>
          </div>
        </div>
      </div>

      <!-- é«˜çº§è®¾ç½® -->
      <div class="control-section collapsible" :class="{ active: showAdvancedSection }" @click="showAdvancedSection = !showAdvancedSection">
        <h3>é«˜çº§è®¾ç½®</h3>
        <div class="collapsible-content">
          <div class="checkbox-group">
            <div class="checkbox-item">
              <input type="checkbox" id="useEcliptic" v-model="settings.s.useEcliptic">
              <label for="useEcliptic">é»„é“é¢/èµ¤é“é¢ (Q)</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="southUp" v-model="settings.s.southUp">
              <label for="southUp">æ­£å—æ–¹å‘æœä¸Š (Y)</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="BeiDouFaceSouth" v-model="settings.s.BeiDouFaceSouth">
              <label for="BeiDouFaceSouth">åŒ—æ–—é¢å—è§‚æµ‹ (W)</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="showLine" v-model="settings.s.showLine">
              <label for="showLine">è¡Œæ˜Ÿè¿çº¿ (B)</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="showSunPlanetTrack" v-model="settings.s.showSunPlanetTrack">
              <label for="showSunPlanetTrack">è¡Œæ˜Ÿè½¨é“ (U)</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="onlyShow7Yao" v-model="settings.s.onlyShow7Yao">
              <label for="onlyShow7Yao">åªæ˜¾ç¤ºä¸ƒæ›œ</label>
            </div>
          </div>
        </div>
      </div>

      <!-- è§‚æµ‹ä½ç½® -->
      <div class="control-section">
        <h3>è§‚æµ‹ä½ç½®</h3>
        <div class="location-inputs">
          <div class="form-group">
            <label>ç»åº¦</label>
            <input type="number" v-model.number="position.s.longitude" step="0.0001">
          </div>
          <div class="form-group">
            <label>çº¬åº¦</label>
            <input type="number" v-model.number="position.s.latitude" step="0.0001">
          </div>
          <div class="form-group" style="grid-column: 1 / -1;">
            <label>æµ·æ‹” (ç±³)</label>
            <input type="number" v-model.number="position.s.altitude">
          </div>
        </div>
        <div class="button-group">
          <button class="btn btn-primary" @click="savePosition()">ä¿å­˜ä½ç½®</button>
          <button class="btn btn-secondary" @click="resetCanvas();paint()">åˆ·æ–°æ˜¾ç¤º</button>
        </div>
      </div>

      <!-- æ—¶é—´è®¾ç½® -->
      <div class="control-section">
        <h3>æ—¶é—´è®¾ç½®</h3>
        <div class="form-group">
          <label>æ—¥æœŸæ—¶é—´</label>
          <div class="time-inputs">
            <input type="number" :value="today.s.year" @input="nowProcess('year', $event.target.value)" placeholder="å¹´">
            <span>å¹´</span>
            <input type="number" :value="today.s.month" @input="nowProcess('month', $event.target.value)" placeholder="æœˆ">
            <span>æœˆ</span>
            <input type="number" :value="today.s.day" @input="nowProcess('day', $event.target.value)" placeholder="æ—¥">
            <span>æ—¥</span>
            <input type="number" :value="today.s.hour" @input="nowProcess('hour', $event.target.value)" placeholder="æ—¶">
            <span>æ—¶</span>
            <input type="number" :value="today.s.minute" @input="nowProcess('minute', $event.target.value)" placeholder="åˆ†">
            <span>åˆ†</span>
            <input type="number" :value="today.s.seconds" @input="nowProcess('seconds', $event.target.value)" placeholder="ç§’">
            <span>ç§’</span>
          </div>
        </div>
        <div class="form-group">
          <label>å¿«æ·æ—¶é—´è·¨åº¦ (E/R)</label>
          <div class="time-span-input">
            <input type="number" v-model="timeSpan" size="3" style="width: 80px;">
            <select v-model="timeUnit" style="width: 60px;">
              <option v-for="r in 'å¹´æœˆæ—¥'" :value="r">{{r}}</option>
            </select>
          </div>
        </div>
      </div>

      <!-- å¿«æ·é”®è¯´æ˜ -->
      <div class="control-section collapsible" :class="{ active: showShortcutsSection }" @click="showShortcutsSection = !showShortcutsSection">
        <h3>å¿«æ·é”®è¯´æ˜</h3>
        <div class="collapsible-content">
          <div class="keyboard-shortcuts">
            <h4>âš ï¸ é‡è¦æç¤ºï¼šæŒ‰Yå›ºå®šæ­£å—æ–¹å‘æœä¸Š</h4>
            <ol>
              <li><strong>J/K</strong> - å‰åä¸€å¤©ï¼ŒæŒ‰ä½Kæ’­æ”¾åŠ¨ç”»</li>
              <li><strong>N/M</strong> - å‰åä¸€å°æ—¶</li>
              <li><strong>D/F</strong> - å‰åä¸€åˆ†é’Ÿ</li>
              <li><strong>I</strong> - åˆ‡æ¢ä¾§è§†å›¾</li>
              <li><strong>O</strong> - åˆ‡æ¢è½¨è¿¹æ¨¡å¼</li>
              <li><strong>A</strong> - è·³åˆ°å†å…ƒï¼š1962å¹´2æœˆ5æ—¥</li>
              <li><strong>Z/X/C</strong> - è·³åˆ°6ç‚¹/0ç‚¹/18ç‚¹</li>
              <li><strong>Shift+X</strong> - è·³åˆ°12ç‚¹</li>
              <li><strong>W</strong> - åˆ‡æ¢åŒ—æ–—è§‚æµ‹è§†è§’</li>
              <li><strong>E/R</strong> - 70å¹´ä¸ºå•ä½è·³è½¬</li>
              <li><strong>G</strong> - 28å®¿360/365.25åº¦åˆ¶</li>
            </ol>
          </div>
        </div>
      </div>
    </aside>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="main-content">
      <!-- ç”»å¸ƒå®¹å™¨ -->
      <div class="canvas-container">
        <canvas id="my"></canvas>
      </div>

      <!-- åº•éƒ¨å¯¼èˆªæ  -->
      <nav class="bottom-nav">
        <div class="nav-buttons">
          <button class="nav-btn" @click="nextday(-1)">å‰ä¸€å¤© (J)</button>
          <button class="nav-btn" @click="nextday(1)">åä¸€å¤© (K)</button>
          <button class="nav-btn" @click="nextHour(-1)">å‰1å°æ—¶ (N)</button>
          <button class="nav-btn" @click="nextHour(1)">å1å°æ—¶ (M)</button>
          <button class="nav-btn" @click="nextMinute(-1)">å‰1åˆ†é’Ÿ (D)</button>
          <button class="nav-btn" @click="nextMinute(1)">å1åˆ†é’Ÿ (F)</button>
          <button class="nav-btn" @click="now.value = new Date(); intIdx = makeInterval(); paint();">ä»Šå¤© (H)</button>
        </div>
      </nav>
    </main>
  </div>
  <script src="js/config.js"></script>
  <script src="js/app.js"></script>
</body>

</html>